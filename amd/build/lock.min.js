/**
 * JavaScript to manage lock/unlock feature.
 *
 * @package mod_openstudio
 * @copyright 2017 The Open University
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_openstudio/lock",["jquery","core/ajax","core/str"],(function($,Ajax,Str){var t;return t={mconfig:null,CSS:{LOCKBUTTON:"#id_lockbutton",ACTIONITEMS:".openstudio-content-actions"},init:function(options){t.mconfig=options,$(t.CSS.LOCKBUTTON).on("click",t.toggleLockContent.bind(t))},toggleLockContent:function(){"locked"==$(t.CSS.LOCKBUTTON).attr("data-lockstate")?t.unlockContent():t.lockContent()},lockContent:function(){M.util.js_pending("openstudioLockContent"),Ajax.call([{methodname:"mod_openstudio_external_lock",args:{cmid:t.mconfig.cmid,cid:t.mconfig.cid,locktype:t.mconfig.CONST.ALL}}])[0].done((function(){var unlockstring=t.mconfig.isfolder?"folderunlockfolder":"contentactionunlockname";Str.get_string(unlockstring,"mod_openstudio").done((function(s){$(t.CSS.LOCKBUTTON).attr("value",s).attr("data-lockstate","locked")})),$(t.CSS.ACTIONITEMS).addClass("locked"),$("#openstudio_item_lock").removeClass("openstudio-item-unlock").addClass("openstudio-item-lock")})).always((function(){M.util.js_complete("openstudioLockContent")})).fail((function(ex){window.console.error("Log request failed "+ex.message)}))},unlockContent:function(){M.util.js_pending("openstudioUnlockContent"),Ajax.call([{methodname:"mod_openstudio_external_unlock",args:{cmid:t.mconfig.cmid,cid:t.mconfig.cid,locktype:t.mconfig.CONST.NONE}}])[0].done((function(){var lockstring=t.mconfig.isfolder?"folderlockfolder":"contentactionlockname";Str.get_string(lockstring,"mod_openstudio").done((function(s){$(t.CSS.LOCKBUTTON).attr("value",s).attr("data-lockstate","unlocked")})),$(t.CSS.ACTIONITEMS).removeClass("locked"),$("#openstudio_item_lock").addClass("openstudio-item-unlock").removeClass("openstudio-item-lock")})).always((function(){M.util.js_complete("openstudioUnlockContent")})).fail((function(ex){window.console.error("Log request failed "+ex.message)}))}}}));

//# sourceMappingURL=lock.min.js.map