/**
 * JavaScript to manage on view page.
 *
 * @package
 * @copyright 2017 The Open University
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_openstudio/viewhelper",["jquery","amd/build/isotope.pkgd.min.js"],(function($,Isotope){var t;return t={isotope:[],mconfig:null,CSS:{SEARCHBOX:"#oustudyplan-query"},init:function(options){t.mconfig=options||{searchtext:""},t.handleFilter(),t.handleIsotope(),t.handleGroupSwitcher(),t.handleViewSizeSwitcher(),t.handleBlockSwitcher(),t.initSearchForm(),t.handleCollapseClick()},handleIsotope:function(){$(".openstudio-grid").each((function(){t.isotope.push(new Isotope("#"+this.id,{layoutMode:"masonry",itemSelector:".openstudio-grid-item",masonry:{columnWidth:243,gutter:20,horizontalOrder:!0}}))})),$(window).on("load",(function(){t.reArrangeItems()}))},reArrangeItems:function(){setTimeout((function(){$.each(t.isotope,(function(i,grid){grid.layout()}))}),1e3)},handleGroupSwitcher:function(){$(document).on("change","#filter_groupid",(function(){t.redirectURL()}))},handleBlockSwitcher:function(){$(document).on("change","#filter_block_activity",(function(){t.redirectURL()}))},handleViewSizeSwitcher:function(){$(document).on("change","#filter_pagesize",(function(){t.redirectURL()}))},redirectURL:function(){var url=$("#view_sort_action_url").val(),vid=$("#vid").val(),groupidelement=$("#groupid");if(groupidelement.length>0){var groupid=groupidelement.val();url=url+"&groupid="+groupid}url=url+"&vid="+vid,$(".openstudio-filter-select-box:visible").each((function(){var name=$(this).attr("name");url=url+"&"+name+"="+$(this).val()})),window.location.href=url},handleFilter:function(){$("#openstudio_filter_types_0").on("click",(function(e){if(!$(this).is(":checked"))return e.preventDefault(),!1;$(".openstudio-filter-types-checkbox").prop("checked",!1),$("#openstudio_filter_types_0").prop("checked",!0)})),$(".openstudio-filter-types-checkbox").on("click",(function(){var checkbox=$(this);checkbox.is(":checked")&&"openstudio_filter_types_0"!=checkbox.attr("id")&&$("#openstudio_filter_types_0").prop("checked",!1),0==$('[name="ftypearray[]"]:checked').length&&$("#openstudio_filter_types_0").prop("checked",!0)})),$("#openstudio_filter_user_flags_0").on("click",(function(e){if(!$(this).is(":checked"))return e.preventDefault(),!1;$(".openstudio-filter-user-flags-checkbox").prop("checked",!1),$("#openstudio_filter_user_flags_0").prop("checked",!0)})),$(".openstudio-filter-user-flags-checkbox").on("click",(function(){var checkbox=$(this);checkbox.is(":checked")&&"openstudio_filter_types_0"!=checkbox.attr("id")&&$("#openstudio_filter_user_flags_0").prop("checked",!1),0==$('[name="fflagarray[]"]:checked').length&&$("#openstudio_filter_user_flags_0").prop("checked",!0)})),$("#reset_filter_btn").on("click",(function(){$("#reset_filter").val(1),$("#filteractive").val(0),$("#openstudio-filter-form").submit()})),$(".openstudio-filter-block").on("click",(function(){var checkbox=$(this),filter_area_activity_value=$("#filter_area_activity_value").val(),length=$('[name="fblockarray[]"]:checked').length;checkbox.is(":checked")&&$("#filter_block").val(filter_area_activity_value),0==length&&$("#filter_block").val(0)})),$("#filter_block").on("change",(function(){var filter_block=$(this).val(),filter_area_activity_value=$("#filter_area_activity_value").val();parseInt(filter_block)==filter_area_activity_value?$("#filter_block").val(0):$(".openstudio-filter-block").prop("checked",!1)})),$(".openstudio-filter-link a").on("click",(function(){var isCollapsed=!$(this).hasClass("collapsed");$($(this).data("target")).find("input, select").attr("tabindex",isCollapsed?-1:0)})),$(".openstudio-filter-link a.collapsed").each((function(){$($(this).data("target")).find("input, select").attr("tabindex",-1)}))},handleCollapseClick:function(){for(var myprofile=document.querySelector(".openstudio-profile-mypaticipation-content"),fullusername=document.getElementById("openstudio_profile_fullusername"),profilleparticipate=document.querySelector("#openstudio_profile_bar .openstudio-profile-bar-participation-content"),profilleparticipatemobile=document.querySelector("#openstudio_profile_bar_mobile .openstudio-profile-bar-participation-content"),progressbar=document.getElementsByClassName("openstudio-profile-progress-content"),showprofile=null,showparticipate=null,body=document.querySelector("body"),i=0;i<progressbar.length;i++)progressbar&&progressbar[i]&&progressbar[i].clientHeight>0&&(showprofile=progressbar[i]);if(showparticipate=body.classList.contains("ios")||body.classList.contains("android")?profilleparticipatemobile:profilleparticipate,fullusername&&showprofile){var originalmarginTop=showprofile.style.marginTop?showprofile.style.marginTop:"0px",originalpaddingTop=showprofile.style.paddingTop?showprofile.style.paddingTop:"0px";fullusername.addEventListener("click",(function(){var w=window.innerWidth;(w>767&&w<1204&&!body.classList.contains("ios")&&!body.classList.contains("android")||w>767&&w<940&&(body.classList.contains("ios")||body.classList.contains("android")))&&(fullusername.classList.contains("collapsed")?setTimeout((function(){showparticipate&&fullusername.clientHeight>21&&(myprofile&&myprofile.getBoundingClientRect().height>showparticipate.getBoundingClientRect().height?showprofile.getBoundingClientRect().top>myprofile.getBoundingClientRect().bottom?showprofile.style.marginTop=originalmarginTop+3+"px":showprofile.style.marginTop=myprofile.getBoundingClientRect().bottom-showprofile.getBoundingClientRect().top+"px":showparticipate&&(showprofile.getBoundingClientRect().top>showparticipate.getBoundingClientRect().bottom?showprofile.style.marginTop=originalmarginTop+3+"px":showprofile.style.marginTop=showparticipate.getBoundingClientRect().bottom-showprofile.getBoundingClientRect().top+"px"),body.classList.contains("ios")||body.classList.contains("android")?showprofile.style.paddingTop="5px":showprofile.style.paddingTop="9px")}),500):(showprofile.style.paddingTop=originalpaddingTop,showprofile.style.marginTop=originalmarginTop))}))}},initSearchForm:function(){$(t.CSS.SEARCHBOX).val(t.mconfig.searchtext)}}}));

//# sourceMappingURL=viewhelper.min.js.map