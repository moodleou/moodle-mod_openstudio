/**
 * JavaScript to view deleted contents feature.
 *
 * @package mod_openstudio
 * @copyright 2017 The Open University
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_openstudio/viewdeleted",["jquery","core/ajax","core/str","require"],(function($,Ajax,Str,require){var t;return t={mconfig:null,CSS:{BOUNDINGCLASS:".openstudio-view-deleted-dialogue",VIEW_DELETED_BUTTON:"#id_viewdeletedpostbutton",RESTORE_BUTTON:".openstudio-restore-deleted-button"},init:function(options){t.mconfig=options,Y.use("moodle-core-notification-dialogue",(function(){require(["mod_openstudio/osdialogue"],(function(osDialogue){t.dialogue=t.createDeletedPostDialogue(osDialogue)}))})),$(t.CSS.VIEW_DELETED_BUTTON).on("click",(function(){t.dialogue&&(t.dialogue.show(),t.resize())})),$("body").delegate(t.CSS.RESTORE_BUTTON,"click",t.restoreContent),$(window).resize(t.resize.bind(t))},createDeletedPostDialogue:function(osDialogue){var dialogue=new osDialogue({closeButton:!0,visible:!1,centered:!0,modal:!0,responsive:!0,width:640,responsiveWidth:767,focusOnPreviousTargetAfterHide:!0,extraClasses:[t.CSS.BOUNDINGCLASS.replace(".",""),"openstudio-folder-posts-dialogue"]});return Str.get_string("folderdeletedposts","mod_openstudio").done((function(s){dialogue.set("headerContent","<span>"+s+"</span>")})),M.util.js_pending("openstudioFetchDeletedContent"),Ajax.call([{methodname:"mod_openstudio_external_fetch_deleted_posts_in_folder",args:{cmid:t.mconfig.cmid,folderid:t.mconfig.folderid}}])[0].done((function(html){dialogue.set("bodyContent",html)})).always((function(){M.util.js_complete("openstudioFetchDeletedContent")})).fail((function(ex){window.console.error("Log request failed "+ex.message)})),dialogue},restoreContent:function(){var cvid=$(this).data("content-version-id");cvid=parseInt(cvid),M.util.js_pending("openstudioRestoreContent"),Ajax.call([{methodname:"mod_openstudio_external_restore_content_in_folder",args:{cmid:t.mconfig.cmid,cvid:cvid,folderid:t.mconfig.folderid}}])[0].done((function(){window.location.reload()})).always((function(){M.util.js_complete("openstudioRestoreContent")})).fail((function(ex){window.console.error("Log request failed "+ex.message)}))},resize:function(){t.dialogue&&t.dialogue.get("visible")&&(Y.one("body").get("winWidth")<t.dialogue.get("responsiveWidth")?(t.dialogue.makeResponsive(),$(t.CSS.RESTORE_BUTTON).removeClass("osep-smallbutton")):($(t.CSS.RESTORE_BUTTON).addClass("osep-smallbutton"),Y.one("body").get("winWidth")>=1e3?t.dialogue.set("width",640):t.dialogue.set("width",500),t.dialogue.centerDialogue()))}}}));

//# sourceMappingURL=viewdeleted.min.js.map