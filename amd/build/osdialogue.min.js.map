{"version":3,"file":"osdialogue.min.js","sources":["../src/osdialogue.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Extend Moodle dialogue.\n *\n * @module mod_openstudio/osdialogue\n * @copyright 2017 The Open University\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Modal from 'core/modal';\nimport ModalEvents from 'core/modal_events';\nimport * as FocusLockManager from 'core/local/aria/focuslock';\n\nexport default class osDialogue extends Modal {\n    static TYPE = 'mod_openstudio/osdialogue';\n    static TEMPLATE = 'mod_openstudio/osdialogue';\n    registerEventListeners() {\n        // Call the parent registration.\n        super.registerEventListeners();\n\n        // Lock tab control inside modal.\n        this.getRoot().on(ModalEvents.shown, () => {\n            FocusLockManager.trapFocus(document.querySelector('.modal-dialog.openstudio-dialogue'));\n        });\n\n        this.getRoot().on(ModalEvents.hidden, () => {\n            FocusLockManager.untrapFocus();\n        });\n\n        // Register to close on save/cancel.\n        this.registerCloseOnCancel();\n    }\n\n    configure(modalConfig) {\n        super.configure(modalConfig);\n    }\n\n    addButton(property, sections) {\n        const self = this;\n        let footer = self.getFooter()[0];\n        sections.forEach(function(section) {\n            if (section === 'footer') {\n                // Create a button element using native JS.\n                const button = document.createElement('button');\n                button.className = property.classNames;\n                button.textContent = property.label;\n\n                // Add event listeners for 'action' or custom events.\n                if (property.action === 'hide') {\n                    button.setAttribute('data-action', 'cancel');\n                }\n\n                if (property.events) {\n                    Object.keys(property.events).forEach(eventType => {\n                        button.addEventListener(eventType, function(event) {\n                            property.events[eventType].apply(self, [event]);\n                        });\n                    });\n                }\n\n                // Collect the button for footer replacement.\n                footer.appendChild(button);\n            }\n        });\n    }\n}\n\nosDialogue.registerModalType();\n"],"names":["osDialogue","Modal","registerEventListeners","getRoot","on","ModalEvents","shown","FocusLockManager","trapFocus","document","querySelector","hidden","untrapFocus","registerCloseOnCancel","configure","modalConfig","addButton","property","sections","self","this","footer","getFooter","forEach","section","button","createElement","className","classNames","textContent","label","action","setAttribute","events","Object","keys","eventType","addEventListener","event","apply","appendChild","registerModalType"],"mappings":"+gDA2BqBA,mBAAmBC,eAGpCC,+BAEUA,8BAGDC,UAAUC,GAAGC,sBAAYC,OAAO,KACjCC,iBAAiBC,UAAUC,SAASC,cAAc,8CAGjDP,UAAUC,GAAGC,sBAAYM,QAAQ,KAClCJ,iBAAiBK,sBAIhBC,wBAGTC,UAAUC,mBACAD,UAAUC,aAGpBC,UAAUC,SAAUC,gBACVC,KAAOC,SACTC,OAASF,KAAKG,YAAY,GAC9BJ,SAASK,SAAQ,SAASC,YACN,WAAZA,QAAsB,OAEhBC,OAAShB,SAASiB,cAAc,UACtCD,OAAOE,UAAYV,SAASW,WAC5BH,OAAOI,YAAcZ,SAASa,MAGN,SAApBb,SAASc,QACTN,OAAOO,aAAa,cAAe,UAGnCf,SAASgB,QACTC,OAAOC,KAAKlB,SAASgB,QAAQV,SAAQa,YACjCX,OAAOY,iBAAiBD,WAAW,SAASE,OACxCrB,SAASgB,OAAOG,WAAWG,MAAMpB,KAAM,CAACmB,cAMpDjB,OAAOmB,YAAYf,gEAhDdzB,kBACH,6CADGA,sBAEC,6BAoDtBA,WAAWyC"}