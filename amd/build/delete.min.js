/**
 * JavaScript to manage delete content feature.
 *
 * @package
 * @copyright 2017 The Open University
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_openstudio/delete",["jquery","core/ajax","core/str","core/config","mod_openstudio/osdialogue"],(function($,Ajax,Str,SiteConfig,osDialogue){var t;return t={mconfig:null,dialogue:null,CSS:{DELETEBUTTON:"#id_deletebutton",DIALOGHEADER:".openstudio-dialogue-common-header",DELETEDIALOGUECONTAINER:".openstudio-delete-dialogue"},init:async function(options){t.mconfig=options,t.dialogue=await t.createDeleteDialogue(),$(t.CSS.DELETEBUTTON).on("click",(function(){t.dialogue&&t.dialogue.show()}))},createDeleteDialogue:async function(){let hasFolderClass="";t.mconfig.isfolder?hasFolderClass="openstudio-folder":t.mconfig.folderid&&(hasFolderClass="openstudio-is-belong-to-folder");const dialogue=await osDialogue.create({isVerticallyCentered:!0,templateContext:{extraClasses:t.CSS.DELETEDIALOGUECONTAINER.replace(".","")+" "+hasFolderClass}});return function(dialogue){const langstring=t.mconfig.isfolder?"folderdeletedfolder":"contentdeledialogueteheader";Str.get_string(langstring,"mod_openstudio").done((function(s){dialogue.setTitle('<span class="'+t.CSS.DIALOGHEADER.replace(".","")+'">'+s+"</span>")}))}(dialogue),function(dialogue){const langstring=t.mconfig.isfolder?"deleteconfirmfolder":"deleteconfirmcontent";Str.get_string(langstring,"mod_openstudio").done((function(s){dialogue.setBody(s)}))}(dialogue),function(dialogue){const cancelBtnProperty={name:"cancel",classNames:"openstudio-delete-cancel-btn",action:"hide"},deleteBtnProperty={name:"delete",classNames:"openstudio-delete-ok-btn",events:{click:t.deleteContent.bind(t)}};Str.get_strings([{key:"modulejsdialogcancel",component:"mod_openstudio"},{key:"deletelevel",component:"mod_openstudio"}]).done((function(s){cancelBtnProperty.label=s[0],deleteBtnProperty.label=s[1],dialogue.addButton(deleteBtnProperty,["footer"]),dialogue.addButton(cancelBtnProperty,["footer"])}))}(dialogue),dialogue},deleteContent:function(){M.util.js_pending("openstudioDeleteContent"),Ajax.call([{methodname:"mod_openstudio_external_delete_content",args:{id:t.mconfig.id,cid:t.mconfig.cid,containingfolder:t.mconfig.folderid}}])[0].done((function(res){var url="";url=t.mconfig.folderid?SiteConfig.wwwroot+"/mod/openstudio/folder.php?sid="+t.mconfig.folderid:t.mconfig.isactivitycontent?window.location.href:SiteConfig.wwwroot+"/mod/openstudio/view.php?vid="+res.vid,url+="&id="+t.mconfig.id,window.location.href=url})).always((function(){M.util.js_complete("openstudioDeleteContent")})).fail((function(ex){window.console.error("Log request failed "+ex.message)}))}}}));

//# sourceMappingURL=delete.min.js.map